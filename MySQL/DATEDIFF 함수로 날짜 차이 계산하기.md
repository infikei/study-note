# DATEDIFF 함수로 날짜 차이 계산하기

> 2024.12.29. 일 작성 (by 인피케이)

## 부제 : MySQL에서 두 날짜 간 차이를 계산할 때는 - 연산자 대신 DATEDIFF 함수를 사용하자.

### 1. `-` 연산자

- MySQL에서 날짜 `YYYY-MM-DD` 는 내부적으로 수 `YYYYMMDD` 로 처리된다.
- 따라서 두 날짜에 대해 `-` 연산자를 사용한다면 날짜 차이가 아닌 수의 뺄셈으로 계산된다.

---

### 2. `DATEDIFF` 함수

- MySQL에서 `DATEDIFF(date1, date2)` 는 두 날짜의 단순한 일 차이를 계산하는 함수이다.

---

### 3. 예시를 통해 알아보는 `-` 연산자와 `DATEDIFF` 함수의 차이

- `HISTORY` 라는 테이블에 타입이 DATE인 `START_DATE` 열과 타입이 DATE인 `END_DATE` 열이 있다고 가정하자. 그리고 `START_DATE` 열이 `2022-08-01` 이면서 `END_DATE` 열이 `2022-11-09` 인 행이 저장되어 있다고 가정하자.
- 이 상황에서 다음 쿼리를 실행할 것이다.

    ```sql
    SELECT START_DATE,
        END_DATE,
        END_DATE - START_DATE AS DIFF1,
        DATEDIFF(END_DATE, START_DATE) AS DIFF2
    FROM HISTORY;
    ```

- 그러면 다음 결과가 나오게 된다.

    | START_DATE | END_DATE | DIFF1 | DIFF2 |
    | --- | --- | --- | --- |
    | 2022-08-01 00:00:00 | 2022-11-09 00:00:00 | 308 | 100 |

- `-` 연산자를 사용한 경우에는 날짜를 `YYYYMMDD` 형태의 수로 처리한 다음 정수끼리의 연산을 수행하기 때문에 `20221109 - 20220801 = 308` 이라는 결과가 나온다.
- 반면 `DATEDIFF` 함수를 사용한 경우에는 두 날짜 간 일 차이를 계산하여 `100` 이라는 결과가 나온다.
- 즉, 두 날짜 사이의 일 차이를 계산하려는 경우에는 `-` 연산자가 아니라 `DATEDIFF` 함수를 사용해야 한다.

---

### 4. 추가로 알아볼 항목

- 단순히 일 차이를 계산할 경우가 아니라 차이를 연, 분기, 월, 주, 일, 시, 분, 초 단위로 지정하여 계산하는 경우라면 `TIMESTAMPDIFF` 함수를 사용한다.
- 특정 날짜에서 특정 연, 월, 일, 시, 분, 초를 더하거나 빼는 경우라면 `DATE_ADD` 함수 또는 `DATE_SUB` 함수를 사용한다.
